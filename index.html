<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>コード順位登録サイト</title>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>
<div id="messageBox" aria-live="polite" style="
  position: fixed;
  bottom: 1rem;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: white;
  padding: 0.8rem 1.2rem;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.3s;
  z-index: 10000;
"></div>

<!-- 順位登録用リスト -->
<h4>順位登録リスト</h4>
<ul id="rankingList" class="ranking-list"></ul>

<!-- レート表 -->
<h4>レート一覧</h4>
<table id="rateTable" border="1"></table>

<h1>QRコードリーダー</h1>
<p>座席（table〜）→ 生徒（player〜）の順に読み取り。6人まで登録。生徒IDクリックで削除可能。</p>

<!-- 現在の座席選択状況表示 -->
<div id="currentSeatDisplay" aria-live="polite" role="region" aria-label="現在の座席選択状況">
  現在の座席: <span id="currentSeatText">未選択</span>
</div>

<!-- QRコード読み取り領域 -->
<div id="reader-wrapper"><div id="reader"></div></div>

<!-- 読み取り結果表示 -->
<div id="result" aria-live="polite" role="status">ここに読み取り結果が表示されます</div>

<!-- 操作ボタン群 -->
<div class="button-group" role="group" aria-label="操作ボタン群">
  <button onclick="downloadCSV()" aria-label="CSVで保存">CSVで保存</button>
  <button id="completeSeatBtn" onclick="completeCurrentSeat()" aria-label="現在の座席登録完了ボタン">この座席の登録を完了</button>
  <button onclick="undoLast()" aria-label="最後の追加を取り消す">最後の追加を取り消す</button>
  <button onclick="clearSavedData()" aria-label="保存データを削除">🗑 保存データを削除</button>
  <button onclick="saveSeatMapToDrive()" aria-label="Google Driveに保存">💾 Google Driveに保存</button>
  <button onclick="loadSeatMapFromDrive()" aria-label="Driveから復元">☁ Driveから復元</button>
  <button onclick="toggleRankingMode()" aria-pressed="false" id="toggleRankingBtn">📋 順位登録モード切替</button>
  <button id="confirmRankingBtn" onclick="confirmRanking()">順位確定</button>
</div>

<div id="ranking-select-ui" style="display: none;">
  <h3>順位を並べ替えてください</h3>
  <ul id="rankingListEdit" class="ranking-list"></ul> <!-- もし編集用に分けたいなら -->
  <button onclick="confirmRanking()">順位確定</button>
</div>

<section class="footer-area" aria-label="現在の座席登録状況">
  <h2>現在の座席登録</h2>
  <table id="seatTable" role="table" aria-describedby="tableDesc" border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse; width: 100%; max-width: 600px;">
    <caption id="tableDesc">座席IDと生徒ID一覧および順位</caption>
    <thead>
      <tr><th scope="col">座席ID</th><th scope="col">生徒ID一覧</th><th scope="col">順位</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

</body>
</html>
